{% extends 'base.html' %}
{% block title %}Take Test Â· CISSP Test Simulator{% endblock %}
{% block content %}
  <div class="row justify-content-center">
    <div class="col-lg-10">
      <form method="post" action="{{ url_for('submit_test') }}" class="card">
        <div class="card-body">
          <h5 class="card-title">{{ 'Review Session' if mode == 'review' else 'Practice Test' }}</h5>
          <p class="card-text">Select the best answer(s) for each question. Questions may have multiple correct answers.</p>
          <div class="accordion" id="testAccordion">
            {% for question in questions %}
              <div class="accordion-item">
                <h2 class="accordion-header" id="heading-{{ loop.index }}">
                  <button class="accordion-button {% if not loop.first %}collapsed{% endif %}" type="button" data-bs-toggle="collapse" data-bs-target="#collapse-{{ loop.index }}" aria-expanded="{{ 'true' if loop.first else 'false' }}" aria-controls="collapse-{{ loop.index }}">
                    <span class="badge bg-secondary me-2">{{ loop.index }}</span>
                    <span>{{ question.question }}</span>
                  </button>
                </h2>
                <div id="collapse-{{ loop.index }}" class="accordion-collapse collapse {% if loop.first %}show{% endif %}" aria-labelledby="heading-{{ loop.index }}" data-bs-parent="#testAccordion">
                  <div class="accordion-body">
                    <fieldset>
                      <legend class="visually-hidden">Question {{ loop.index }}</legend>
                      {% for choice in question.choices %}
                        <div class="form-check">
                          <input class="form-check-input" type="checkbox" value="{{ loop.index0 }}" id="{{ question.id }}-{{ loop.index0 }}" name="q_{{ question.id }}">
                          <label class="form-check-label" for="{{ question.id }}-{{ loop.index0 }}">
                            {{ choice }}
                          </label>
                        </div>
                      {% endfor %}
                      <div class="form-text">Domain: {{ question.domain }}</div>
                    </fieldset>
                  </div>
                </div>
              </div>
            {% endfor %}
          </div>
        </div>
        <div class="card-footer d-flex justify-content-between align-items-center">
          <span class="text-muted">Questions: {{ questions|length }}</span>
          <button type="submit" class="btn btn-primary">Submit Answers</button>
        </div>
      </form>
    </div>
  </div>
{% endblock %}
